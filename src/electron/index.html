<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <title>KCCacheProxy</title>
  <link rel="stylesheet" href="index.css">
  <script defer src="render.js"></script>
</head>

<body>
  <div id="title">
    <h1 id="mainTitle">KCCacheProxy</h1>
    <div id="support">
      <span class="align"></span>
      <a href="https://ko-fi.com/A0A81MOVN" class="link">
        <img height="30" style="border:0px;height:30px;" src="./support.png" border="0" alt="Support me at ko-fi.com" />
      </a>
    </div>
  </div>
  <div id="update" style="display:none">
    You are currently using an outdated version. The latest version is <span id="newVersion"></span>.
    <a id="openReleases">Open releases page</a>
  </div>
  <button id="checkVersion">Check for updates</button><br>
  <button id="startHelp">Having troubles? Start the troubleshooter</button>
  <a id="openFAQ">FAQ</a>
  <br>
  <div id="help" style="display:none;">
    <h2>Troubleshooter</h2>
    <div id="not-started">
      Please refresh your game and wait a bit, game might take a bit to load.<br>
    </div>

    <div id="loading">
      <b>Potential issues:</b>
      <ul>
        <li id="no-connection">Nothing is coming through the proxy, double check settings for your viewer.</li>
        <li id="no-connection-with-gadget">Gadget server isn't coming through the proxy, double check settings for your viewer.</li>
        <li id="no-cache">You don't have the minimum cache installed, click on <code>Import built-in basic cache dump</code>.</li>
        <li id="no-index">Game in maintenance or no KC server going through proxy, double check settings for your viewer.</li>
        <li id="no-main">Game is not being loaded from proxy, try clearing browser cache.</li>
        <li id="no-version">It looks like the game isn't getting started, try clearing browser cache.</li>
      </ul>
    </div>
    <div id="done">
      Everything looks fine from here. If you are still having issues contact me on Discord via <a href="https://discord.gg/J7nBD6U" class="link">https://discord.gg/J7nBD6U</a>.<br><br>
      <a id="stopHelp">Close troubleshooter</a>
    </div>
  </div>
  <h2>Stats:</h2>
  Cached: <span id="cachedFiles">?</span> files, <span id="cachedSize">?</span>
  <span id="oldCache" class="info"
    title="Note: This IS inaccurate since your cache was made in an old version">*</span><br>
  Since installation (<span id="startDate"></span>):<br>
  <ul>
    <li style="display:none" id="passthrough"><span class="info"
        title="These are passed through, not dropped">Ignored</span> <span id="passthroughHTTP">0</span> HTTP requests
      and <span id="passthroughHTTPS">0</span> HTTPS requests.</li>
    <li>Handled <span id="totalHandled">0</span> requests
      <ul>
        <li style="display:none" id="inCacheH"><span id="inCache">0</span> found in cache</li>
        <li style="display:none" id="notModifiedH"><span id="notModified">0</span> changed version tag, but weren't
          modified
          <span class="info"
            title="Note: These aren't included in the 'found in cache' count. These were loaded from cache, but still required to be checked if not modified from KC servers.">*</span>
        </li>
        <li style="display:none" id="fetchedH"><span id="fetched">0</span> had to be downloaded from KC servers</li>
        <li style="display:none" id="blockedH"><span id="blocked">0</span> blocked by KC servers</li>
        <li style="display:none" id="failedH"><span id="failed">0</span> failed to load</li>
      </ul>
    </li>
    <li>Saved <span id="bandwidthSaved">0 B</span> of bandwidth.</li>
  </ul>
  <div class="h2">
    <h2 style="display: inline;">Settings: </h2><a id="openConfigWiki">More information</a>
  </div>
  <div id="settings"></div>
  <button id="save" disabled>Save</button><br>
  <button id="reloadCache">Reload cache</button>
  <button id="verifyCache">Verify entire cache (might take a bit)</button>
  <button id="importCache">Import built-in basic cache dump</button>
  <button id="importCustomCache">Import cache dump</button>
  <a id="openCacheDump">Where/how to get cache dumps</a>
  <div style="display:none" id="extraButtons">
    <button id="preload">Preload</button>
    <button id="createDiff">Create diff</button>
  </div>
  <div style="display:none" id="modder">
    <h2>Assets modifier</h2>
    Stable assets modifier. More stable than replacing assets directly. See <a id="openAssetsWiki">wiki page</a> for more information.<br>
    <b>NOTE:</b> Use this feature on your own risk.
    <h4>Enabled mods</h4>
    <ol id="mods"></ol>
    <button id="addMod">Add a patcher</button>
    <button id="reloadMods">Reload mod data</button><br>
    <button id="prepatch">Pre-patch ALL assets (might take a while)</button>
    <button id="extractSpritesheet">Extract a spritesheet</button>
    <button id="outlines">Make outlines of spritesheet</button>
    <button id="importExternalMod">Convert from poi</button>
    <button id="installGitMod">Install mod from GitHub</button>
    <div id="gitModInstall" style="display:none; margin: 10px 0;">
      <input type="text" id="gitModUrl" placeholder="Enter GitHub repository URL" style="width: 300px; margin-right: 5px;">
      <button id="confirmGitModInstall">Install</button>
      <button id="cancelGitModInstall">Cancel</button>
    </div>
  </div>
  <h2>Proxy log:</h2>
  <div id="log"></div>
</body>

</html>